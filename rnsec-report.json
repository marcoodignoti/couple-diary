{
  "findings": [
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/stores/authStore.ts",
      "line": 86,
      "snippet": "            }\r\n        } catch (error: any) {\r\n            console.error('Failed to refresh profile:', error.message);\r\n        }\r\n    },\r",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/stores/authStore.ts",
      "line": 198,
      "snippet": "            set({ partner });\r\n        } catch (error: any) {\r\n            console.error('Failed to fetch partner:', error.message);\r\n        }\r\n    },\r",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/stores/entryStore.ts",
      "line": 91,
      "snippet": "            set({ timeCapsuleEntry: data || null });\r\n        } catch (error: any) {\r\n            console.error('Time capsule fetch error:', error.message);\r\n        }\r\n    },\r",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/app/(auth)/pairing.tsx",
      "line": 31,
      "snippet": "            }\r\n        } catch (error) {\r\n            console.error('Error checking existing code:', error);\r\n        }\r\n    };\r",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/app/(auth)/pairing.tsx",
      "line": 43,
      "snippet": "            setPairingCode(code);\r\n            setMode('generate');\r\n        } catch (error: any) {\r\n            Alert.alert('Errore', error.message);\r\n        } finally {\r",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/app/(auth)/pairing.tsx",
      "line": 64,
      "snippet": "            Alert.alert('Connesso! ðŸ’•', 'Ora siete collegati. Buona scrittura!');\r\n            router.replace('/(tabs)');\r\n        } catch (error: any) {\r\n            Alert.alert('Errore', error.message);\r\n        } finally {\r",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/app/(tabs)/profile.tsx",
      "line": 40,
      "snippet": "                setPairingCode(code);\r\n            }\r\n        } catch (error: any) {\r\n            Alert.alert('Errore', error.message);\r\n        } finally {\r",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/app/entry/[id].tsx",
      "line": 36,
      "snippet": "            setReactions(data);\r\n        } catch (error) {\r\n            console.error('Failed to load reactions:', error);\r\n        }\r\n    };\r",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "C:/Users/marco/couple-diary/app/entry/[id].tsx",
      "line": 48,
      "snippet": "            Alert.alert('ðŸ’•', 'Cuore aggiunto!');\r\n            loadReactions();\r\n        } catch (error: any) {\r\n            Alert.alert('Errore', error.message);\r\n        } finally {\r",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    }
  ],
  "scannedFiles": 45,
  "duration": 904,
  "timestamp": "2026-01-14T13:03:02.669Z"
}